<SCRIPT src="http://code.jquery.com/jquery-1.9.1.min.js"></SCRIPT>
<SCRIPT src="http://localhost:8080/javascripts/_config.tmp.js"></SCRIPT>

<SCRIPT>
    var server = server_ip + ":" + server_port;   // defined in _config.tmp.js, maintained in index.js
    window.onerror = postit;
    function fireerror(){
        alrrr(111);
    }
    var sent_msg;
    var sent_url;
    var sent_line;
    function postit(sMsg,sUrl,sLine){

        if(sent_msg == sMsg && sent_url == sUrl && sent_line == sLine) {
            // skip the duplicate
        }else{
            var data = '{reporttype:"1",msg:"' + sMsg + '",url:"' + sUrl + '",line:"' + sLine + '"}';
            data = encodeURIComponent(data);
            console.log(data);
            $.ajax({
                type : "get",
                async:false,
                url : "http://" + server + "/services/report_window_on_error.do",
                data: "report=" + data,
                dataType : "jsonp",
                jsonp: "callbackparam",//传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(默认为:callback)
                jsonpCallback:"success_jsonpCallback",//自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名
                success : function(json){
                    console.log(json);
                    sent_msg = sMsg;
                    sent_url = sUrl;
                    sent_line = sLine;
                },
                error:function(){
                    console.error("report fail");
                }
            });
            console.log("It's sent.");
        }
        return false;
    }
</SCRIPT>
<input type="button" value="fire_js_error" onclick="fireerror()"/>
<a href="http://www.1234xxxx.com/?epl=DtbJsl0-xgG7TQ-hwZJATk7Q-5IgoXCK5C7-l2d92cJ9wYoHI9XBE4hPGKD48XXVIDH6YkPfhDMzeZTdduoWUY0hnZwDCwS00FBEmyVzAwkJQRFispAjOlYuHfzWZTiUzbpHNA1AE1MPTcSmniIoYwBopCc9TdNQDXUAIFDe578AAOB_BQAAQIDbCAAAJ-h9SVlTJllBMTZoWkJ6AAAA8A">fire http error 400</a>
